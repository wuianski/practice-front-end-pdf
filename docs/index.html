<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>美術館刊物與它的數位想像</title>

    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="lib/OverlayScrollbars.css">
    <script src="lib/OverlayScrollbars.js" crossorigin="anonymous"></script>
    <script src="lib/tween.umd.js"></script>
</head>

<body>

    <img id="site_logo" src="assets/imgs/site_logo.png" alt="'site logo">

    <!---- menu  ---->
    <div id="menu">
        <div onclick="popUp1()">
            <img class="bt" id="bt1" src="assets/imgs/bt1.png" alt="button info">
        </div>
        <div onclick="popUp2()">
            <img class="bt" id="bt2" src="assets/imgs/bt2.png" alt="button share">
        </div>
        <div>
            <img class="bt" id="bt3" src="assets/imgs/bt3.png" alt="button link">
        </div>
    </div>

    <!---- Slides container ---->
    <div class="slides_container show" id="popup_slide">

        <!---- Full-width images with number and caption text ---->
        <div class="mySlides fade">
            <picture>
                <source media="(max-width: 799px)" srcset="assets/imgs/slide1_mobile.png">
                <source media="(min-width: 800px)" srcset="assets/imgs/slide1.png">
                <img id="slideW1" src="assets/imgs/slide1.png" alt="introduction">
            </picture>
        </div>

        <div class="mySlides fade">
            <picture>
                <source media="(max-width: 799px)" srcset="assets/imgs/slide2_mobile.png">
                <source media="(min-width: 800px)" srcset="assets/imgs/slide2.png">
                <img id="slideW2" src="assets/imgs/slide2.png" alt="guide">
            </picture>
            <!--<div id="subs">Caption Two</div>-->
        </div>

        <!---- Next and previous buttons ---->
        <a class="prev" onclick="plusSlides(-1)"><img class="arrow" src="assets/imgs/arrow_l.png" alt="prev slide"></a>
        <a class="next" onclick="plusSlides(1)"><img class="arrow" src="assets/imgs/arrow_r.png" alt="next slide"></a>
    </div>

    <!---- Share container ---->
    <div class="share_container show2" id="popup_share">
        <div class="myShare fade">
            <picture>
                <source media="(max-width: 799px)" srcset="assets/imgs/share_mobile.png">
                <source media="(min-width: 800px)" srcset="assets/imgs/share.png">
                <img id="share_bg" src="assets/imgs/share.png">
            </picture>
            <div onclick="close_share()">
                <img id="close_btn" src="assets/imgs/close.png">
            </div>
            <div onclick="download_pdf()">
                <img id="download_pdf" src="assets/imgs/download_pdf.png">
            </div>
            <div onclick="share_img()">
                <img id="share_img" src="assets/imgs/share_img.png">
            </div>
        </div>
    </div>

    <script>

        //// Create the A1_iframe ////
        var iframeSource_A1 = 'assets/articles/A1.html';
        var A1_iframe = document.createElement('iframe');
        A1_iframe.setAttribute('src', iframeSource_A1);
        A1_iframe.setAttribute('id', 'A1_iframe');
        document.body.appendChild(A1_iframe);
        //// Create the A1_iframe ////

        //// Create the imgA1 ////
        var imgA1 = document.createElement("IMG");
        imgA1.setAttribute('id', 'imgA1');
        imgA1.setAttribute("src", "assets/imgs/A1.png");
        imgA1.setAttribute("alt", "imgA1");
        imgA1.style.setProperty('width', '200px')
        //imgA1.style.position = "absolute";
        document.body.appendChild(imgA1);
        //// Create the imgA1 ////

        //// Receive postMessege from iframe ////
        // addEventListener support for IE8
        function bindEvent(element, eventName, eventHandler) {
            if (element.addEventListener) {
                element.addEventListener(eventName, eventHandler, false);
            } else if (element.attachEvent) {
                element.attachEvent('on' + eventName, eventHandler);
            }
        }
        // Listen to message from child window
        bindEvent(window, 'message', function (e) {
            //results.innerHTML = e.data;
            //var s1 = results.innerHTML;
            var s1 = e.data;
            console.log(s1);
            //var a1 = document.getElementById('imgA1');
            //a1.style.left = s1 + 'px';
            if (s1 > 0 && s1 < 99) {
                onUpdateEventA();
            } else if (s1 > 100) {
                onUpdateEventB();
            };

        });
        //// Receive postMessege from iframe ////

        //// Tween the imgA1 ////
        // Setup the animation loop.
        /*function animate(time) {
            requestAnimationFrame(animate)
            TWEEN.update(time)
        }
        requestAnimationFrame(animate)*/

        const coords = { x: 0, y: 0 } // Start at (0, 0)
        const scale = { sx: 1, sy: 1 } // Start at (1, 1)
        var groupA = new TWEEN.Group()
        var groupB = new TWEEN.Group()
        const tweenA = new TWEEN.Tween(coords, groupA) // Create a new tween that modifies 'coords'.
            .to({ x: '+150', y: '+130' }, 1000) // Move to (+150, +130) in 1 second.
            .easing(TWEEN.Easing.Quadratic.Out) // Use an easing function to make the animation smooth.
            .onUpdate(() => {
                // Called after tween.js updates 'coords'.
                // Move 'imgA1' to the position described by 'coords' with a CSS translation.
                imgA1.style.setProperty('transform', `translate(${coords.x}px, ${coords.y}px)`)
                //imgA1.style.setProperty('transform', `scale(${coords.s1}, ${coords.s2})`)
            })
            .start() // Start the tween immediately.  

        const tweenB = new TWEEN.Tween(scale, groupB) // Create a new tween that modifies 'scale'.
            .to({ sx: '+1', sy: '+1' }, 1000) // Move to (+1, +1) in 1 second.
            .easing(TWEEN.Easing.Quadratic.Out) // Use an easing function to make the animation smooth.
            .onUpdate(() => {
                // Called after tween.js updates 'scale'.
                // Move 'imgA1' to the size described by 'scale' with a CSS translation.
                imgA1.style.setProperty('transform', `scale(${scale.sx}, ${scale.sy})`)
                //imgA1.style.setProperty('transform', `scale(${coords.s1}, ${coords.s2})`)
            })
            .start() // Start the tween immediately.  

        function onUpdateEventA() {
            //TWEEN.update();
            groupA.update();
            tweenA.start();
        }
        function onUpdateEventB() {
            //TWEEN.update();
            groupB.update();
            tweenB.start();
        }

        //// Tween the imgA1 ////


        var iframeSource_A2 = 'assets/articles/A2.html';
        // Create the iframe
        var A2_iframe = document.createElement('iframe');
        A2_iframe.setAttribute('src', iframeSource_A2);
        A2_iframe.setAttribute('id', 'A2_iframe');
        document.body.appendChild(A2_iframe);



    </script>

    <!--<script src="myKonva.js"></script>-->

    <!--<script src="pdf.js"></script>-->
    <script src="transition.js"></script>
</body>

</html>